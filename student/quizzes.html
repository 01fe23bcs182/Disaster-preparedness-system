<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Quizzes</title>
<link rel="stylesheet" href="../css/style.css">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="../js/firebase-config.js"></script>
<script>
const auth = firebase.auth();
const db = firebase.firestore();

// Check if user is logged in
auth.onAuthStateChanged(user => {
    if(!user){
        window.location.href = '../index.html';
    }
});

// Simple quizzes data (can later store in Firestore)
const quizzes = [
    {id: 1, question: "What should you do in case of an earthquake?", options: ["Run outside immediately","Drop, Cover, Hold On","Call friends"], answer: 1},
    {id: 2, question: "What is the first step in fire safety?", options: ["Hide","Use fire extinguisher","Stay calm and alert others"], answer: 2},
];

let score = 0;
let current = 0;

const quizContainer = document.createElement('div');
document.body.appendChild(quizContainer);

function showQuiz(){
    if(current >= quizzes.length){
        quizContainer.innerHTML = `<h3>Quiz completed! Score: ${score}/${quizzes.length}</h3>`;
        // Save score in Firestore
        const user = auth.currentUser;
        db.collection('quiz-scores').doc(user.uid).set({
            score: score,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        return;
    }

    const q = quizzes[current];
    quizContainer.innerHTML = `<h3>Q${current+1}: ${q.question}</h3>`;
    q.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(i);
        quizContainer.appendChild(btn);
        quizContainer.appendChild(document.createElement('br'));
    });
}

function checkAnswer(selected){
    if(selected === quizzes[current].answer) score++;
    current++;
    showQuiz();
}

showQuiz();
</script>
</body>
</html>

